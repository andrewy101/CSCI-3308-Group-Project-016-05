<%- include ('../partials/head') %>
<%- include ('../partials/menu') %>
<main>
 <!-- //per month -->

<!-- Like a word document -->

    <div class="col"><%- include ('../partials/message') %></div>
    <div class="container">
  
        <h4 class="display-4">Create Expense Report</h4>
        <form action ="/report" method = "get">
            <select class="form-select" type="month" name="month" class="form-group" id="monthInput" onchange="this.form.submit();">
                <option value="-1">Select a month</option>
                <option value="1">January</option>
                <option value="2">February</option>
                <option value="3">March</option>
                <option value="4">April</option>
                <option value="5">May</option>
                <option value="6">June</option>
                <option value="7">July</option>
                <option value="8">August</option>
                <option value="9">September</option>
                <option value="10">October</option>
                <option value="11">November</option>
                <option value="12">December</option>
            </select>
        </form>


        <% if(Expenses[0].length>0) {%>
          
          <h3>Monthly report for <%- Expenses[2][0].monthstring%>:</h3>

        <table class="table" style="width:100%;padding:10px;">
            <thead>
                <tr>
                    <th>Expense</th>                
                    <th>Amount</th>
                    <th>Date</th>
                    <th>Category</th>
                </tr>
            </thead>
            <tbody>
                <%Expenses[0].forEach(Expenses => { %>
                    <!-- table data  -->
                    <tr>
                        <td><%- Expenses.description %></td>
                        <%if(!Expenses.income){%>
                            <td><%-"-$".concat(Expenses.amount)%></td>

                         <%}else{%>
                            <td>$<%-Expenses.amount%></td>
                         <%}%>
                        <td><%- Expenses.date.toLocaleDateString() %></td>                      
                        <td><%- Expenses.category %></td>
                    </tr>

                <% })%>
                
                <tr>
                    <th>Total spending:</th>
                    <td>$<%- Expenses[1][0].monthlytotalspendings.toFixed(2) %></td>
                </tr>  
                <tr>
                    <th>Total income:</th>
                    <td>$<%- Expenses[1][0].monthlytotalincome.toFixed(2) %></td>
                </tr>
                <tr>
                    <th>Total:</th>
                    <td style=<%=(Expenses[1][0].monthlytotalincome - Expenses[1][0].monthlytotalspendings)>=0 ? 'color:green' : 'color:red'%>>$<%- (Expenses[1][0].monthlytotalincome - Expenses[1][0].monthlytotalspendings).toFixed(2) %></td>
                </tr>
            </tbody>
        </table>
        
        
        <%} else{ %>
          <h3>No data available for this month</h3>
        <%}%>

        </div>
    </div>
</main>


<%- include ('../partials/footer') %>